<!DOCTYPE html>
<html>
<head>
    <title>Network Selector Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .info { margin: 10px 0; padding: 10px; background: #f0f0f0; }
        button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h1>Network Selector Debug</h1>
    
    <div class="info">
        <h3>Current State:</h3>
        <p>Chain Manager Current Chain: <span id="currentChain">Loading...</span></p>
        <p>Chain Manager Config Name: <span id="configName">Loading...</span></p>
        <p>LocalStorage selectedChain: <span id="storageChain">Loading...</span></p>
        <p>Network Display Name Element: <span id="displayNameContent">Loading...</span></p>
        <p>Brand Suffix Text: <span id="brandSuffixContent">Loading...</span></p>
    </div>
    
    <div class="info">
        <h3>Actions:</h3>
        <button onclick="switchToEthereum()">Switch to Ethereum</button>
        <button onclick="switchToBase()">Switch to Base</button>
        <button onclick="updateDisplay()">Force Update Display</button>
        <button onclick="refreshState()">Refresh State Info</button>
    </div>
    
    <div class="info">
        <h3>Console Output:</h3>
        <pre id="console" style="background: black; color: lime; padding: 10px; height: 200px; overflow-y: auto;"></pre>
    </div>

    <script type="module">
        import { chainManager } from './js/config/chainConfig.js';
        import { networkSelector } from './js/ui/networkSelectorFixed.js';
        
        window.chainManager = chainManager;
        window.networkSelector = networkSelector;
        
        function log(msg) {
            const consoleEl = document.getElementById('console');
            consoleEl.textContent += msg + '\n';
            consoleEl.scrollTop = consoleEl.scrollHeight;
            console.log(msg);
        }
        
        window.refreshState = function() {
            try {
                document.getElementById('currentChain').textContent = chainManager.getCurrentChain();
                document.getElementById('configName').textContent = chainManager.getCurrentConfig()?.name || 'N/A';
                document.getElementById('storageChain').textContent = localStorage.getItem('selectedChain') || 'Not set';
                
                const displayNameEl = document.getElementById('networkDisplayName');
                document.getElementById('displayNameContent').textContent = displayNameEl ? displayNameEl.textContent : 'Element not found';
                
                const brandSuffixEl = document.querySelector('.brand-suffix-text');
                document.getElementById('brandSuffixContent').textContent = brandSuffixEl ? brandSuffixEl.textContent : 'Element not found';
                
                log(`State refreshed at ${new Date().toLocaleTimeString()}`);
            } catch (error) {
                log(`Error refreshing state: ${error.message}`);
            }
        };
        
        window.switchToEthereum = function() {
            log('Switching to Ethereum...');
            chainManager.setChain('ETHEREUM');
            log(`Chain set to: ${chainManager.getCurrentChain()}`);
            log(`Config name: ${chainManager.getCurrentConfig().name}`);
            refreshState();
        };
        
        window.switchToBase = function() {
            log('Switching to Base...');
            chainManager.setChain('BASE');
            log(`Chain set to: ${chainManager.getCurrentChain()}`);
            log(`Config name: ${chainManager.getCurrentConfig().name}`);
            refreshState();
        };
        
        window.updateDisplay = function() {
            log('Forcing display update...');
            if (window.networkSelector && window.networkSelector.updateDisplay) {
                window.networkSelector.updateDisplay();
                log('Display update called');
            } else {
                log('Network selector not available');
            }
            refreshState();
        };
        
        // Initial load
        setTimeout(() => {
            log('Initial load...');
            chainManager.initialize();
            log(`Chain manager initialized with: ${chainManager.getCurrentChain()}`);
            refreshState();
        }, 100);
        
        // Listen for chain changes
        chainManager.onChainChange((newChain, config) => {
            log(`Chain changed to: ${newChain} (${config.name})`);
            refreshState();
        });
    </script>
</body>
</html>