<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WenXen Design Documentation</title>
    <script src="https://unpkg.com/@viz-js/viz@3.4.0/lib/viz-standalone.js"></script>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/theme-light.css">
    <link rel="stylesheet" href="css/theme-dark.css">
    <style>
        body {
            font-family: var(--font-family);
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
            line-height: 1.8;
            background: var(--background);
            color: var(--text-primary);
        }
        body.theme-light {
            background: #ffffff;
            color: #24292e;
        }
        body.theme-dark {
            background: #0d1117;
            color: #c9d1d9;
        }
        h1 {
            color: #24292e;
            border-bottom: 3px solid #e1e4e8;
            padding-bottom: 24px;
            margin-bottom: 48px;
            font-size: 3.2em;
            font-weight: 600;
            text-align: center;
            letter-spacing: -0.5px;
        }
        body.theme-dark h1 {
            color: #c9d1d9;
            border-bottom-color: #30363d;
        }
        h2 {
            color: #24292e;
            margin-top: 56px;
            margin-bottom: 28px;
            font-size: 2.2em;
            font-weight: 600;
            border-bottom: 2px solid #e1e4e8;
            padding-bottom: 12px;
            letter-spacing: -0.3px;
        }
        body.theme-dark h2 {
            color: #c9d1d9;
            border-bottom-color: #30363d;
        }
        h3 {
            color: var(--text-primary);
            margin-top: 30px;
            margin-bottom: 20px;
            font-size: 1.6em;
        }
        .toc {
            background: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            padding: 32px;
            margin-bottom: 48px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        body.theme-dark .toc {
            background: #161b22;
            border-color: #30363d;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .toc h2 {
            margin-top: 0;
            border: none;
            text-align: center;
        }
        .toc ol {
            columns: 2;
            column-gap: 40px;
        }
        .toc li {
            margin: 10px 0;
            break-inside: avoid;
        }
        .toc a {
            color: #0969da;
            text-decoration: none;
            font-weight: 500;
        }
        body.theme-dark .toc a {
            color: #58a6ff;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        .code-block {
            background: var(--background-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }
        .code-block pre {
            margin: 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: var(--text-primary);
        }
        .warning-box {
            background: #fff3cd;
            border: 2px solid #ffecb5;
            border-radius: 10px;
            padding: 20px;
            margin: 25px 0;
            position: relative;
            color: #856404;
        }
        .warning-box::before {
            content: "‚ö†Ô∏è";
            font-size: 1.5em;
            position: absolute;
            left: 20px;
            top: 20px;
        }
        .warning-box p {
            margin-left: 40px;
        }
        .tip-box {
            background: #d4edda;
            border: 2px solid #c3e6cb;
            border-radius: 10px;
            padding: 20px;
            margin: 25px 0;
            position: relative;
            color: #155724;
        }
        .tip-box::before {
            content: "üí°";
            font-size: 1.5em;
            position: absolute;
            left: 20px;
            top: 20px;
        }
        .tip-box p {
            margin-left: 40px;
        }
        .humor-box {
            background: #f3f4f6;
            color: #4b5563;
            border-radius: 8px;
            padding: 24px;
            margin: 32px 0;
            font-style: italic;
            text-align: center;
            font-size: 1.05em;
            border: 1px solid #e5e7eb;
        }
        body.theme-dark .humor-box {
            background: #1f2937;
            color: #9ca3af;
            border-color: #374151;
        }
        .feature-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
        }
        .feature-table th {
            background: var(--accent-color);
            color: white;
            padding: 15px;
            text-align: left;
        }
        .feature-table td {
            padding: 15px;
            border: 1px solid var(--border-color);
            background: var(--background);
            color: var(--text-primary);
        }
        .feature-table tr:nth-child(even) td {
            background: var(--background-secondary);
        }
        body.theme-dark .feature-table td {
            background: #0d1117;
            border-color: #30363d;
        }
        body.theme-dark .feature-table tr:nth-child(even) td {
            background: #161b22;
        }
        .architecture-section {
            background: #f6f8fa;
            border-left: 4px solid #0969da;
            padding: 24px;
            margin: 32px 0;
            border-radius: 6px;
        }
        body.theme-dark .architecture-section {
            background: #161b22;
            border-left-color: #58a6ff;
        }
        .file-tree {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.95em;
            line-height: 1.6;
            color: var(--text-primary);
        }
        .flow-diagram {
            padding: 30px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 20px 0;
        }
        body.theme-dark .flow-diagram {
            background: #161b22;
        }
        .flow-box {
            display: inline-block;
            padding: 12px 24px;
            background: white;
            border: 2px solid #0969da;
            border-radius: 6px;
            margin: 10px;
            font-weight: 600;
            color: #24292e;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        body.theme-dark .flow-box {
            background: #0d1117;
            color: #c9d1d9;
            border-color: #58a6ff;
        }
        .flow-arrow {
            display: inline-block;
            margin: 0 10px;
            color: #586069;
            font-size: 24px;
        }
        body.theme-dark .flow-arrow {
            color: #8b949e;
        }
        .diagram-container {
            background: #ffffff;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            padding: 28px;
            margin: 32px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            text-align: center;
            overflow-x: auto;
        }
        body.theme-dark .diagram-container {
            background: #0d1117;
            border-color: #30363d;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .diagram-container svg {
            max-width: 100%;
            height: auto;
        }
        .quote {
            font-style: italic;
            border-left: 4px solid #d1d5da;
            padding-left: 24px;
            margin: 32px 0;
            color: #586069;
            font-size: 1.1em;
        }
        body.theme-dark .quote {
            border-left-color: #484f58;
            color: #8b949e;
        }
        body.theme-dark .warning-box {
            background: rgba(255, 243, 205, 0.1);
            border-color: #ffecb5;
            color: #f0ad4e;
        }
        body.theme-dark .tip-box {
            background: rgba(212, 237, 218, 0.1);
            border-color: #c3e6cb;
            color: #5cb85c;
        }
        body.theme-dark .humor-box {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%);
        }
    </style>
</head>
<body class="theme-light">
    <h1>WenXen Technical Design Document</h1>
    
    <div class="humor-box">
        "The best code is no code at all. The second best is code that runs entirely in your browser with zero servers. 
        Welcome to WenXen - where we took 'serverless' so literally that even when you visit wenxen.com, 
        you're still running everything locally. We're just a fancy file server with trust issues."
    </div>

    <div class="toc">
        <h2 style="border: none; margin-top: 0;">Table of Contents</h2>
        <ol>
            <li><a href="#philosophy">Design Philosophy & Architecture</a></li>
            <li><a href="#tech-stack">Technology Stack Deep Dive</a></li>
            <li><a href="#module-architecture">Module Architecture & Patterns</a></li>
            <li><a href="#scanner-internals">Scanner Internals & Block Enumeration</a></li>
            <li><a href="#database-design">Database Design & Migration Strategy</a></li>
            <li><a href="#flow-diagrams">System Flow Diagrams</a></li>
            <li><a href="#performance">Performance Optimization Techniques</a></li>
            <li><a href="#security">Security Model & Privacy</a></li>
            <li><a href="#deployment">Deployment Architecture</a></li>
            <li><a href="#api-integration">External API Integration</a></li>
            <li><a href="#wallet-integration">Wallet Integration Deep Dive</a></li>
            <li><a href="#ui-architecture">UI Component Architecture</a></li>
            <li><a href="#error-handling">Error Handling & Recovery</a></li>
            <li><a href="#testing">Testing & Quality Assurance</a></li>
            <li><a href="#future">Future Architecture Considerations</a></li>
        </ol>
    </div>

    <h2 id="philosophy">Design Philosophy & Architecture</h2>
    
    <div class="quote">
        "If you're not paranoid about privacy, you're not paying attention. If you're not obsessed with decentralization, you're building wrong."
    </div>

    <h3>Core Principles</h3>
    <div class="architecture-section">
        <p><strong>1. Zero Trust in Servers</strong><br>
        We don't have servers. Not because we can't afford them (okay, maybe that too), but because YOUR data should stay YOURS. Every byte of data lives in your browser's IndexedDB. When you close the tab, your data stays. When you clear your browser, it's gone. Simple as that.</p>
        
        <p><strong>2. Client-Side Everything</strong><br>
        Processing? Client-side. Storage? Client-side. Logic? You guessed it - client-side. The only external calls are to public blockchain RPCs and explorer APIs. We're basically a sophisticated calculator that happens to understand Web3.</p>
        
        <p><strong>3. No Build Process Religion</strong><br>
        While the rest of the world is fighting over webpack configs and arguing about whether to use Vite or Turbopack, we just... don't. Open index.html, and it works. Revolutionary? No. Refreshing? Absolutely.</p>
    </div>

    <div class="humor-box">
        "We use vanilla JavaScript. Not because we're hipsters (we are), but because we believe in the radical idea that 
        browsers can actually run JavaScript without 47 build steps."
    </div>

    <h2 id="tech-stack">Technology Stack Deep Dive</h2>

    <h3>The Glorious Tech Stack</h3>
    <table class="feature-table">
        <tr>
            <th>Layer</th>
            <th>Technology</th>
            <th>Why We Chose It</th>
            <th>The Real Reason</th>
        </tr>
        <tr>
            <td>Frontend Framework</td>
            <td>None (Vanilla JS)</td>
            <td>Maximum performance, zero overhead</td>
            <td>React was giving us trust issues</td>
        </tr>
        <tr>
            <td>Module System</td>
            <td>ES6 Modules</td>
            <td>Native browser support</td>
            <td>CommonJS is so 2015</td>
        </tr>
        <tr>
            <td>Data Tables</td>
            <td>Tabulator v6.3</td>
            <td>Feature-rich, performant</td>
            <td>AG-Grid wanted our firstborn</td>
        </tr>
        <tr>
            <td>Storage</td>
            <td>IndexedDB</td>
            <td>Large capacity, async API</td>
            <td>LocalStorage is for amateurs</td>
        </tr>
        <tr>
            <td>Web3 Library</td>
            <td>Web3.js v1.7.5</td>
            <td>Battle-tested, stable</td>
            <td>Ethers.js docs made us cry</td>
        </tr>
        <tr>
            <td>Build Tool</td>
            <td>Your Browser</td>
            <td>Zero config needed</td>
            <td>npm install takes longer than our entire app loads</td>
        </tr>
    </table>

    <h2 id="module-architecture">Module Architecture & Patterns</h2>

    <h3>The Sacred Module Pattern</h3>
    <div class="code-block">
        <pre>// Every module follows this pattern because consistency is sexy
export const moduleManager = {
    init() {
        // Initialization logic that makes angels sing
        this.setupEventListeners();
        this.loadStoredPreferences();
        this.sacrificeGoatToWebpackGods(); // Just kidding, no webpack here
    },
    
    destroy() {
        // Cleanup like your mother-in-law is visiting
        this.removeEventListeners();
        this.saveState();
        this.weep(); // Optional but recommended
    }
};

// Global access because we're not afraid of the window object
window.moduleFunction = () => moduleManager.doSomething();</pre>
    </div>

    <div class="tip-box">
        <p><strong>Pro Tip:</strong> Yes, we pollute the global scope. No, we're not sorry. When you don't have a build process, 
        sometimes you just need to access things globally. Deal with it. üòé</p>
    </div>

    <h3>File Structure (Or: How We Organize Our Chaos)</h3>
    <div class="file-tree">
        <pre>/
‚îú‚îÄ‚îÄ index.html              # The alpha and omega
‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îú‚îÄ‚îÄ base.css           # Where CSS variables live their best life
‚îÇ   ‚îú‚îÄ‚îÄ theme-light.css    # For people who like retina burn
‚îÇ   ‚îî‚îÄ‚îÄ theme-dark.css     # For real developers
‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îú‚îÄ‚îÄ config/            # Configuration that configures configurations
‚îÇ   ‚îú‚îÄ‚îÄ utils/             # Utils that util (500+ functions of pure joy)
‚îÇ   ‚îú‚îÄ‚îÄ blockchain/        # Web3 magic happens here
‚îÇ   ‚îú‚îÄ‚îÄ scanners/          # The workhorses that never complain
‚îÇ   ‚îú‚îÄ‚îÄ ui/                # Making things pretty since 2024
‚îÇ   ‚îî‚îÄ‚îÄ data/              # Database wranglers anonymous
‚îú‚îÄ‚îÄ ABI/                   # Contract interfaces (boring but necessary)
‚îî‚îÄ‚îÄ deployment/            # AWS stuff for the cloud believers</pre>
    </div>

    <h2 id="scanner-internals">Scanner Internals & Block Enumeration</h2>

    <div class="warning-box">
        <p><strong>Warning:</strong> Our scanners use block enumeration. Yes, it's slow. Yes, we know about event filters. 
        No, we don't care. Block enumeration is like a diesel truck - not fast, not pretty, but it'll get you there every single time.</p>
    </div>

    <h3>The Scanner Philosophy</h3>
    <div class="architecture-section">
        <p>Each scanner is like a dedicated detective with OCD:</p>
        <ul>
            <li><strong>cointool_scanner.js</strong> - Finds Cointool mints faster than you can say "batch mint"</li>
            <li><strong>xenft_scanner.js</strong> - Discovers XENFTs through sheer determination and 50k block chunks</li>
            <li><strong>xen_scanner.js</strong> - The OG scanner for native XEN operations</li>
            <li><strong>xenft_stake_scanner.js</strong> - Tracks staking like a bloodhound tracks bacon</li>
        </ul>
    </div>

    <h3>Block Enumeration Flow</h3>
    <div class="diagram-container" id="block-enum-diagram"></div>

    <div class="humor-box">
        "Rate limiting: Because getting banned from Etherscan is embarrassing. Trust us, we know."
    </div>

    <h2 id="database-design">Database Design & Migration Strategy</h2>

    <h3>IndexedDB: Our Database of Choice</h3>
    <div class="architecture-section">
        <p>Why IndexedDB? Because LocalStorage has a 5MB limit and we're not peasants. Our users have THOUSANDS of XEN operations, and we store them all. Every. Single. One.</p>
        
        <p><strong>Database Structure:</strong></p>
        <ul>
            <li>One database per chain (because mixing Ethereum and Base data is like mixing wine and beer)</li>
            <li>Object stores for each data type (mints, stakes, XENFTs)</li>
            <li>Indexes on everything that moves (and some things that don't)</li>
        </ul>
    </div>

    <h3>Migration Safety Levels (Choose Your Adventure)</h3>
    <table class="feature-table">
        <tr>
            <th>Level</th>
            <th>File</th>
            <th>Speed</th>
            <th>Safety</th>
            <th>Use When</th>
        </tr>
        <tr>
            <td>Ultra Safe</td>
            <td>databaseMigrationUltraSafe.js</td>
            <td>üê¢ Glacial</td>
            <td>üõ°Ô∏èüõ°Ô∏èüõ°Ô∏èüõ°Ô∏èüõ°Ô∏è</td>
            <td>You have trust issues</td>
        </tr>
        <tr>
            <td>Super Safe</td>
            <td>databaseMigrationSuperSafe.js</td>
            <td>üêå Slow</td>
            <td>üõ°Ô∏èüõ°Ô∏èüõ°Ô∏èüõ°Ô∏è</td>
            <td>Normal paranoia levels</td>
        </tr>
        <tr>
            <td>Safe</td>
            <td>databaseMigrationSafe.js</td>
            <td>üö∂ Moderate</td>
            <td>üõ°Ô∏èüõ°Ô∏èüõ°Ô∏è</td>
            <td>Balanced approach</td>
        </tr>
        <tr>
            <td>Standard</td>
            <td>databaseMigration.js</td>
            <td>üèÉ Fast</td>
            <td>üõ°Ô∏èüõ°Ô∏è</td>
            <td>Living dangerously</td>
        </tr>
    </table>

    <h2 id="flow-diagrams">System Flow Diagrams</h2>

    <h3>Application Initialization Sequence</h3>
    <div class="diagram-container" id="init-sequence-diagram"></div>

    <h3>Multi-Chain Architecture</h3>
    <div class="diagram-container" id="multi-chain-diagram"></div>

    <h2 id="performance">Performance Optimization Techniques</h2>

    <h3>The Art of Not Being Slow</h3>
    <div class="architecture-section">
        <p><strong>1. Lazy Loading Everything</strong><br>
        We load things when we need them. Revolutionary? No. Effective? Absolutely. Your grandmother's computer can run this.</p>
        
        <p><strong>2. Strategic Caching</strong><br>
        We cache everything that doesn't change often. Block timestamps? Cached. XEN prices? Cached for 5 minutes (because checking every second won't make you rich faster).</p>
        
        <p><strong>3. Rate Limiting</strong><br>
        200ms between API calls. Not because we're slow, but because Etherscan will literally ban you if you're too eager. Ask us how we know.</p>
        
        <p><strong>4. Chunked Processing</strong><br>
        50,000 blocks at a time for XENFT scanning. Why 50k? Because 100k made browsers cry and 25k was for quitters.</p>
    </div>

    <div class="tip-box">
        <p><strong>Performance Secret:</strong> The fastest code is the code that doesn't run. We skip unnecessary updates, 
        avoid redundant calculations, and generally try not to do stupid things. It's harder than it sounds.</p>
    </div>

    <h2 id="security">Security Model & Privacy</h2>

    <h3>Security Through Simplicity</h3>
    <div class="warning-box">
        <p><strong>Security Model:</strong> We can't leak your data if we never have it. We can't get hacked if we don't have servers. 
        We can't sell your information if we don't collect it. Sometimes the best security is just... not being a target.</p>
    </div>

    <h3>What We Don't Do (A Love Letter to Privacy)</h3>
    <ul>
        <li>‚ùå No user accounts (forgot your password? Too bad, we don't know you)</li>
        <li>‚ùå No telemetry (we have no idea if anyone uses this)</li>
        <li>‚ùå No cookies (except the ones you eat while coding)</li>
        <li>‚ùå No tracking pixels (pixels should be for art, not surveillance)</li>
        <li>‚ùå No data sales (we're developers, not data brokers)</li>
    </ul>

    <h3>What We Do (The Boring Security Stuff)</h3>
    <ul>
        <li>‚úÖ Read-only blockchain access (we can look but not touch)</li>
        <li>‚úÖ API keys stored locally (your keys, your browser, your problem)</li>
        <li>‚úÖ MetaMask/Rabby for signing (let the pros handle the scary stuff)</li>
        <li>‚úÖ HTTPS only in production (because 2024)</li>
    </ul>

    <h2 id="deployment">Deployment Architecture</h2>

    <h3>Access Options (Choose Your Fighter)</h3>
    
    <div class="architecture-section">
        <h4>Option 1: WenXen.com (The Easy Button)</h4>
        <ul>
            <li>Visit <strong>wenxen.com</strong> - boom, you're done</li>
            <li>No downloads, no setup, just works</li>
            <li>Hosted on AWS but <strong>still 100% client-side</strong></li>
            <li>We literally cannot see your data - it's all in YOUR browser</li>
            <li>Cost to you: $0 (we eat the hosting costs)</li>
        </ul>
        
        <h4>Option 2: GitHub Pages (The Developer's Choice)</h4>
        <ul>
            <li>Fork our repo on GitHub</li>
            <li>Enable Pages in settings</li>
            <li>Your own instance at username.github.io/wenxen</li>
            <li>Complete control over the code</li>
            <li>Cost: $0 (GitHub's treat)</li>
        </ul>
        
        <h4>Option 3: Local File (The Paranoid's Paradise)</h4>
        <ul>
            <li>Download from GitHub</li>
            <li>Open index.html locally</li>
            <li>Works offline, no internet required (except for blockchain calls)</li>
            <li>Trust nobody, not even us</li>
            <li>Cost: Your hard drive space</li>
        </ul>
        
        <h4>Option 4: Self-Host (The Control Freak)</h4>
        <ul>
            <li>Deploy to your own AWS/Azure/GCP</li>
            <li>Use our Terraform scripts or roll your own</li>
            <li>Your domain, your rules</li>
            <li>Cost: $1-3/month in cloud fees</li>
        </ul>
    </div>

    <div class="tip-box">
        <p><strong>Privacy Note:</strong> Whether you use wenxen.com or run it locally, the application works EXACTLY the same way - 
        everything runs in your browser. WenXen.com is just a CDN serving static files. We don't have servers, databases, or any way 
        to see your data. It's like we're a library that handed you a calculator - we don't know what you calculate with it.</p>
    </div>

    <div class="humor-box">
        "We host wenxen.com for your convenience, but we're so privacy-focused that we don't even know if anyone uses it. 
        No analytics, no logs, no cookies. We're basically hosting a party and wearing blindfolds."
    </div>

    <h2 id="api-integration">External API Integration</h2>

    <h3>The APIs We Love (And Occasionally Curse At)</h3>
    
    <table class="feature-table">
        <tr>
            <th>API</th>
            <th>Purpose</th>
            <th>Rate Limit</th>
            <th>Our Feelings</th>
        </tr>
        <tr>
            <td>Etherscan</td>
            <td>Transaction history</td>
            <td>5 calls/second</td>
            <td>Love-hate relationship</td>
        </tr>
        <tr>
            <td>BaseScan</td>
            <td>Base chain data</td>
            <td>5 calls/second</td>
            <td>Etherscan's cooler sibling</td>
        </tr>
        <tr>
            <td>CoinGecko</td>
            <td>XEN prices</td>
            <td>10-50 calls/minute</td>
            <td>Usually reliable</td>
        </tr>
        <tr>
            <td>DexScreener</td>
            <td>Backup prices</td>
            <td>Very generous</td>
            <td>Our safety net</td>
        </tr>
        <tr>
            <td>Blockchain RPCs</td>
            <td>Everything Web3</td>
            <td>Varies wildly</td>
            <td>Necessary evil</td>
        </tr>
    </table>

    <h3>API Fallback Strategy</h3>
    <div class="code-block">
        <pre>// Our sophisticated fallback system
async function getXenPrice() {
    try {
        return await CoinGecko.getPrice();  // First choice
    } catch (e) {
        console.log("CoinGecko is having a moment");
        try {
            return await DexScreener.getPrice();  // Plan B
        } catch (e2) {
            console.log("DexScreener also down");
            return lastKnownPrice || "ü§∑";  // Plan C: Guess
        }
    }
}</pre>
    </div>

    <h2 id="wallet-integration">Wallet Integration Deep Dive</h2>

    <h3>The Wallet Dance</h3>
    <div class="diagram-container" id="wallet-dance-diagram"></div>

    <div class="tip-box">
        <p><strong>Wallet Tip:</strong> We support MetaMask and Rabby. Why not WalletConnect? Because we enjoy sleeping at night 
        instead of debugging WebSocket connections.</p>
    </div>

    <h2 id="ui-architecture">UI Component Architecture</h2>

    <h3>Component Hierarchy (It's Not Complicated, We Promise)</h3>
    
    <div class="architecture-section">
        <h4>The Tab System</h4>
        <p>Four tabs. That's it. We had five once, but it felt excessive.</p>
        <ul>
            <li><strong>Dashboard:</strong> Where the magic happens (and by magic, we mean tables)</li>
            <li><strong>Settings:</strong> Configure all the things</li>
            <li><strong>Scanner:</strong> The workhorse tab</li>
            <li><strong>About:</strong> You are here</li>
        </ul>
        
        <h4>The Theme System</h4>
        <p>Light mode and dark mode. We spent 3 weeks on the color schemes. Time well spent? Debatable.</p>
        
        <h4>The Modal System</h4>
        <p>Modals for privacy, modals for errors, modals for success. If in doubt, show a modal.</p>
    </div>

    <h3>Tabulator Configuration (Our Table Overlord)</h3>
    <div class="code-block">
        <pre>// Tabulator config that took way too long to perfect
const tableConfig = {
    height: "600px",  // Not too tall, not too short
    layout: "fitDataTable",  // Because fitColumns is for quitters
    responsiveLayout: "collapse",  // Mobile users matter too
    pagination: true,  // Nobody wants to see 10,000 rows at once
    paginationSize: 100,  // Goldilocks zone
    movableColumns: true,  // Let users play with columns
    resizableRows: false,  // We're not monsters
    placeholder: "No data. Time to scan!",  // Encouraging emptiness
};</pre>
    </div>

    <h2 id="error-handling">Error Handling & Recovery</h2>

    <h3>The Error Philosophy</h3>
    <div class="quote">
        "Errors are not failures; they're opportunities to show witty error messages."
    </div>

    <h3>Error Handling Strategies</h3>
    
    <div class="architecture-section">
        <p><strong>Level 1: The Optimist</strong></p>
        <pre>try {
    await doSomethingRisky();
} catch (e) {
    console.log("This is fine üî•");
}</pre>
        
        <p><strong>Level 2: The Realist</strong></p>
        <pre>try {
    await doSomethingRisky();
} catch (e) {
    console.error("Houston, we have a problem:", e);
    showToast("Something went wrong. Try again?");
}</pre>
        
        <p><strong>Level 3: The Paranoid (Our Approach)</strong></p>
        <pre>try {
    await doSomethingRisky();
} catch (e) {
    console.error("Error details:", e);
    logErrorToIndexedDB(e);
    showDetailedErrorModal(e);
    offerRecoveryOptions();
    notifyDeveloper();  // Just kidding
    panicQuietly();     // This is real
}</pre>
    </div>

    <h2 id="testing">Testing & Quality Assurance</h2>

    <div class="warning-box">
        <p><strong>Our Testing Strategy:</strong> We test in production. Just kidding! (Mostly.) We actually have a rigorous 
        testing process that involves clicking buttons and seeing if things break. It's more sophisticated than it sounds.</p>
    </div>

    <h3>Testing Checklist</h3>
    <ul>
        <li>‚úÖ Does it work on Chrome? (Primary target)</li>
        <li>‚úÖ Does it work on Firefox? (We care about you too)</li>
        <li>‚úÖ Does it work on Safari? (Reluctantly tested)</li>
        <li>‚úÖ Does it work on Edge? (It's just Chrome now)</li>
        <li>‚ùå Does it work on IE11? (Hahahaha no)</li>
    </ul>

    <h3>Quality Metrics We Track</h3>
    <table class="feature-table">
        <tr>
            <th>Metric</th>
            <th>Target</th>
            <th>Current</th>
            <th>Status</th>
        </tr>
        <tr>
            <td>Page Load Time</td>
            <td>&lt; 2 seconds</td>
            <td>1.5 seconds</td>
            <td>‚úÖ Crushing it</td>
        </tr>
        <tr>
            <td>JavaScript Errors</td>
            <td>0</td>
            <td>0*</td>
            <td>‚úÖ *That we know of</td>
        </tr>
        <tr>
            <td>Mobile Responsive</td>
            <td>100%</td>
            <td>95%</td>
            <td>‚ö†Ô∏è Tables are hard</td>
        </tr>
        <tr>
            <td>User Happiness</td>
            <td>100%</td>
            <td>Unknown</td>
            <td>ü§∑ No telemetry, remember?</td>
        </tr>
    </table>

    <h2 id="future">Future Architecture Considerations</h2>

    <h3>Things We Might Do (But Probably Won't)</h3>
    
    <div class="architecture-section">
        <h4>1. Add a Backend</h4>
        <p>Pros: Could cache data, reduce API calls<br>
        Cons: Servers cost money, privacy concerns, more complexity<br>
        Verdict: <strong>Nah, we're good</strong></p>
        
        <h4>2. Rewrite in React/Vue/Svelte/[Framework of the Month]</h4>
        <p>Pros: Modern development experience, component reusability<br>
        Cons: Build process, dependency hell, breaking changes every week<br>
        Verdict: <strong>Vanilla JS forever</strong></p>
        
        <h4>3. Add More Blockchains</h4>
        <p>Pros: More users, more XEN ecosystems<br>
        Cons: More complexity, more testing, more scanners<br>
        Verdict: <strong>Maybe, if you ask nicely</strong></p>
        
        <h4>4. Implement WebAssembly for Performance</h4>
        <p>Pros: Faster processing, closer to metal<br>
        Cons: Complexity, debugging nightmare<br>
        Verdict: <strong>When JavaScript becomes the bottleneck (never)</strong></p>
    </div>

    <div class="humor-box">
        "The future is uncertain, but one thing is clear: we'll still be running in your browser, 
        still have no servers, and still be paranoid about your privacy. Some things never change."
    </div>

    <h2>Final Thoughts</h2>

    <div class="quote">
        "WenXen is more than just code; it's a philosophy. A philosophy that says 'your computer is powerful enough,' 
        'your browser is smart enough,' and 'your data is yours alone.' We built this for the community, by the community, 
        and it will always remain open source."
    </div>

    <div class="architecture-section">
        <h3>The WenXen Promise</h3>
        <ul>
            <li>We will never add servers (unless we absolutely have to)</li>
            <li>We will never track you (we don't even know how many users we have)</li>
            <li>We will never sell your data (we literally can't - it never leaves your browser)</li>
            <li>We will always be open source (AGPL-3.0 forever)</li>
            <li>We will keep the vanilla JS dream alive (frameworks are overrated)</li>
            <li>WenXen.com will always be free to use (no premium tiers, no ads, no BS)</li>
        </ul>
    </div>

    <div class="tip-box">
        <p><strong>Developer Note:</strong> If you've read this far, you're either very thorough or very bored. 
        Either way, thanks for caring about the architecture. Feel free to contribute, fork, or just admire from afar. 
        The code is at github.com/YourRepo/wenxen.com - pull requests welcome, especially if they're funny.</p>
    </div>

    <div class="humor-box" style="margin-top: 50px; margin-bottom: 50px;">
        "Remember: In a world of microservices, Kubernetes clusters, and distributed systems, 
        we chose to put everything in one HTML file and call it a day. 
        Sometimes the best architecture is no architecture. üöÄ"
    </div>

    <script>
        // Theme synchronization
        function syncTheme() {
            try {
                const parentTheme = window.parent.document.body.classList.contains('theme-dark') ? 'theme-dark' : 'theme-light';
                document.body.className = parentTheme;
                // Re-render diagrams when theme changes
                renderDiagrams();
            } catch (e) {
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.body.className = 'theme-dark';
                }
                renderDiagrams();
            }
        }

        // Diagram rendering function
        async function renderDiagrams() {
            const isDarkMode = document.body.classList.contains('theme-dark');
            
            // Theme-aware colors
            const bgColor = isDarkMode ? '#0d1117' : '#ffffff';
            const nodeColor = isDarkMode ? '#161b22' : '#e3f2fd';
            const fontColor = isDarkMode ? '#c9d1d9' : '#24292e';
            const edgeColor = isDarkMode ? '#58a6ff' : '#0969da';
            const borderColor = isDarkMode ? '#30363d' : '#0969da';
            
            // Block Enumeration Flow Diagram
            const blockEnumDot = `
                digraph BlockEnum {
                    rankdir=TB;
                    bgcolor="${bgColor}";
                    node [shape=box, style="rounded,filled", fillcolor="${nodeColor}", fontcolor="${fontColor}", color="${borderColor}"];
                    edge [color="${edgeColor}", fontcolor="${fontColor}"];
                    
                    start [label="Start Scan"];
                    check [label="Got Blocks?", shape=diamond];
                    cry [label="Cry Softly"];
                    chunk [label="Chunk em up"];
                    rate [label="Apply Rate Limit\\n(200ms delay)"];
                    filter [label="Filter Events"];
                    extract [label="Extract Data"];
                    store [label="Store in DB"];
                    more [label="More Blocks?", shape=diamond];
                    victory [label="Victory Dance"];
                    
                    start -> check;
                    check -> cry [label="No"];
                    check -> chunk [label="Yes"];
                    chunk -> rate;
                    rate -> filter;
                    filter -> extract;
                    extract -> store;
                    store -> more;
                    more -> chunk [label="Yes"];
                    more -> victory [label="No"];
                }
            `;
            
            // Application Initialization Sequence
            const initSequenceDot = `
                digraph InitSequence {
                    rankdir=LR;
                    bgcolor="${bgColor}";
                    node [shape=box, style="rounded,filled", fillcolor="${nodeColor}", fontcolor="${fontColor}", color="${borderColor}"];
                    edge [color="${edgeColor}", fontcolor="${fontColor}"];
                    
                    subgraph cluster_0 {
                        label = "User";
                        fontcolor="${fontColor}";
                        color="${borderColor}";
                        user [label="Opens\\nindex.html"];
                    }
                    
                    subgraph cluster_1 {
                        label = "Browser";
                        fontcolor="${fontColor}";
                        color="${borderColor}";
                        browser [label="Load\\nModules"];
                    }
                    
                    subgraph cluster_2 {
                        label = "Application";
                        fontcolor="${fontColor}";
                        color="${borderColor}";
                        app1 [label="Clean\\nDatabase"];
                        app2 [label="Check\\nPreferences"];
                        app3 [label="Initialize\\nComponents"];
                    }
                    
                    subgraph cluster_3 {
                        label = "UI";
                        fontcolor="${fontColor}";
                        color="${borderColor}";
                        ui1 [label="Apply\\nTheme"];
                        ui2 [label="Show\\nPrivacy Modal"];
                        ui3 [label="Ready"];
                    }
                    
                    user -> browser;
                    browser -> app1;
                    app1 -> app2;
                    app2 -> app3;
                    app3 -> ui1;
                    ui1 -> ui2;
                    ui2 -> ui3;
                }
            `;
            
            // Multi-Chain Architecture
            const multiChainDot = `
                digraph MultiChain {
                    rankdir=TB;
                    bgcolor="${bgColor}";
                    node [shape=box, style="rounded,filled", fillcolor="${nodeColor}", fontcolor="${fontColor}", color="${borderColor}"];
                    edge [color="${edgeColor}", fontcolor="${fontColor}"];
                    
                    subgraph cluster_abstraction {
                        label = "Chain Abstraction Layer";
                        fontcolor="${fontColor}";
                        style=filled;
                        fillcolor="${isDarkMode ? '#1a1a1a' : '#f0f0f0'}";
                        color="${borderColor}";
                        
                        manager [label="Chain Manager"];
                        config [label="Chain Config"];
                        state [label="Chain State"];
                    }
                    
                    subgraph cluster_ethereum {
                        label = "Ethereum";
                        fontcolor="${fontColor}";
                        style=filled;
                        fillcolor="${isDarkMode ? '#0d2818' : '#e8f5e9'}";
                        color="#238636";
                        
                        eth_rpc [label="ETH RPCs"];
                        eth_contracts [label="ETH Contracts"];
                        eth_db [label="ethereum_db"];
                    }
                    
                    subgraph cluster_base {
                        label = "Base";
                        fontcolor="${fontColor}";
                        style=filled;
                        fillcolor="${isDarkMode ? '#1e1a2e' : '#f3e5f5'}";
                        color="#8957e5";
                        
                        base_rpc [label="Base RPCs"];
                        base_contracts [label="Base Contracts"];
                        base_db [label="base_db"];
                    }
                    
                    manager -> eth_rpc;
                    manager -> base_rpc;
                    config -> eth_contracts;
                    config -> base_contracts;
                    state -> eth_db;
                    state -> base_db;
                    
                    eth_rpc -> eth_contracts;
                    eth_contracts -> eth_db;
                    base_rpc -> base_contracts;
                    base_contracts -> base_db;
                }
            `;
            
            // Wallet Dance Diagram
            const walletDanceDot = `
                digraph WalletDance {
                    rankdir=TB;
                    bgcolor="${bgColor}";
                    node [shape=box, style="rounded,filled", fillcolor="${nodeColor}", fontcolor="${fontColor}", color="${borderColor}"];
                    edge [color="${edgeColor}", fontcolor="${fontColor}"];
                    
                    user [label="User Clicks\\nConnect Wallet"];
                    app [label="App"];
                    metamask [label="MetaMask/Rabby"];
                    blockchain [label="Blockchain"];
                    
                    request [label="Request\\nConnection", shape=ellipse];
                    prompt [label="User\\nApproval", shape=diamond];
                    address [label="Return\\nAddress", shape=ellipse];
                    network [label="Check\\nNetwork", shape=ellipse];
                    switch [label="Switch\\nNetwork?", shape=diamond];
                    scan [label="Start\\nScanning", shape=ellipse];
                    
                    user -> app [label="Click"];
                    app -> request;
                    request -> metamask [label="ethereum.request()"];
                    metamask -> prompt;
                    prompt -> address [label="Approved"];
                    address -> app;
                    app -> network;
                    network -> switch;
                    switch -> metamask [label="Wrong Network"];
                    switch -> scan [label="Correct Network"];
                    scan -> blockchain;
                }
            `;
            
            // Render all diagrams
            try {
                const viz = await Viz.instance();
                
                // Render Block Enumeration
                const blockEnumContainer = document.getElementById('block-enum-diagram');
                if (blockEnumContainer) {
                    const svg = await viz.renderString(blockEnumDot, { format: 'svg' });
                    blockEnumContainer.innerHTML = svg;
                }
                
                // Render Init Sequence
                const initContainer = document.getElementById('init-sequence-diagram');
                if (initContainer) {
                    const svg = await viz.renderString(initSequenceDot, { format: 'svg' });
                    initContainer.innerHTML = svg;
                }
                
                // Render Multi-Chain
                const multiChainContainer = document.getElementById('multi-chain-diagram');
                if (multiChainContainer) {
                    const svg = await viz.renderString(multiChainDot, { format: 'svg' });
                    multiChainContainer.innerHTML = svg;
                }
                
                // Render Wallet Dance
                const walletContainer = document.getElementById('wallet-dance-diagram');
                if (walletContainer) {
                    const svg = await viz.renderString(walletDanceDot, { format: 'svg' });
                    walletContainer.innerHTML = svg;
                }
            } catch (error) {
                console.error('Error rendering diagrams:', error);
            }
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            syncTheme();
            renderDiagrams();
        });
        
        // Listen for theme changes
        window.addEventListener('message', (event) => {
            if (event.data && event.data.type === 'theme-change') {
                document.body.className = event.data.theme;
                renderDiagrams();
            }
        });
    </script>
</body>
</html>